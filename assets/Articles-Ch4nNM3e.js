import{d as R,r as h,o as F,a as I,w as q,c as m,b as s,e as z,t as T,u as H,v as N,f as b,n as V,F as E,g as $,h as G,i as p,j as C,k as M,_ as L,l as A,m as O,s as j,p as K,q as W,A as J}from"./index-CjRLZPMe.js";import{t as k,D as Q,c as X,S as f,A as Y,F as Z,a as ee}from"./ArticleSearchPanel-BTjYdEeW.js";const te={class:"article-tags-selector"},se={class:"header"},ae={class:"title"},le={class:"tag-count"},oe=R({__name:"TagExplorerPanel",setup(P){const n=h(!1),v=h(!1),l=h(null),_=h(null);F(()=>{l.value&&(_.value=new ResizeObserver(()=>{D()}),_.value.observe(l.value)),D()}),I(()=>{_.value&&_.value.disconnect()});const D=()=>{w(),S()},w=()=>{if(l.value===null)return;const r=l.value,g=r.style.maxHeight;r.style.maxHeight="none";const y=r.scrollHeight;r.style.maxHeight=g;const c=r.querySelector(".tag-item")?.clientHeight||0;y>c?v.value=!0:(v.value=!1,n.value=!1)},S=()=>{if(l.value!==null)if(n.value)l.value.style.maxHeight="none";else{const r=l.value.querySelector(".tag-item")?.clientHeight||0;l.value.style.maxHeight=`${r}px`}};return q(n,S),window.addEventListener("resize",w),(r,g)=>{const y=G("router-link");return p(),m("div",te,[s("div",se,[s("span",ae,"总共有 "+T(H(k).length)+" 个标签",1),z(s("button",{class:"toggle-btn",onClick:g[0]||(g[0]=c=>n.value=!n.value)},[b(T(n.value?"收起":"展开")+" ",1),s("span",{class:V(["arrow",n.value?"up":"down"])},null,2)],512),[[N,v.value]])]),s("div",{ref_key:"tagsContainerRef",ref:l,class:"tags-container"},[(p(!0),m(E,null,$(H(k),c=>(p(),m("div",{key:c[0],class:"tag-item"},[C(y,{to:{path:"/tag",query:{tag:c[0]}},class:"tag-link"},{default:M(()=>[g[1]||(g[1]=s("span",{class:"bullet"},null,-1)),b(" "+T(c[0]),1)]),_:2},1032,["to"]),s("span",le,"("+T(c[1])+")",1)]))),128))],512)])}}}),ne=L(oe,[["__scopeId","data-v-20ddb300"]]),re={class:"body_container"},ie={class:"filter-container"},ce={class:"article-count-container"},ue={key:0},de={key:1},pe={class:"article-count"},ve={class:"articles"},ge={class:"articles-container"},me={key:0,class:"empty-state"},he=R({__name:"Articles",setup(P){const n=h(""),v=h({...Q}),l=h(X()),_=A(()=>{const{sortProperty:e}=v.value;return e===f.DEFAULT||e===f.UPDATED_DATE}),D=A(()=>{const{sortProperty:e}=v.value;return e===f.DEFAULT}),w=/<span>(.*?)<\/span>/gi,S=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),r=A(()=>l.value.rules.some(e=>e.values.length>0)),g=(e,t)=>{const a=t.type===Z.TAG?e.tags:e.categories;return t.operator==="eq"?t.values.some(o=>a.includes(o)):t.values.every(o=>!a.includes(o))},y=e=>{const t=l.value.rules.filter(o=>o.values.length>0);if(t.length===0)return e;const a=l.value.matchMode==="all";return e.filter(o=>{const i=t.map(u=>g(o,u));return a?i.every(Boolean):i.some(Boolean)})},c=A(()=>{const e=n.value.trim(),t=O.map(d=>({...d,title:d.title.replace(w,"$1")})).filter(d=>d.title.toLocaleLowerCase().replace(/\s+/g,"").includes(e.toLocaleLowerCase().replace(/\s+/g,""))),a=y(t);if(e==="")return a;const o=e.replace(/\s+/g,""),i=Array.from(o).map(d=>S(d)).join("\\s*"),u=new RegExp(i,"gi");return a.map(d=>({...d,title:d.title.replace(u,U=>`<span>${U}</span>`)}))}),x=A(()=>{const e=[...c.value],{sortDirection:t,sortProperty:a}=v.value;if(a===f.DEFAULT)return e.sort((i,u)=>u.updatedDate.localeCompare(i.updatedDate));const o=t==="ASC"?1:-1;if(f.CREATED_DATE===a)return e.sort((i,u)=>o*i.createdDate.localeCompare(u.createdDate));if(f.UPDATED_DATE===a)return e.sort((i,u)=>o*i.updatedDate.localeCompare(u.updatedDate));throw Error("Invalid sort property")}),B=(e,t,a)=>{v.value={...t},n.value=e,l.value=ee(a)};return F(()=>document.title=`${j.siteInfo.title} | 归档`),(e,t)=>(p(),m(E,null,[t[2]||(t[2]=s("div",{class:"title_container"},[s("p",{class:"main_title"},"归档")],-1)),s("div",re,[C(ne,{style:{"margin-bottom":"1.5em"}}),s("div",ie,[C(Y,{onSubmit:B}),s("div",ce,[n.value===""&&!r.value?(p(),m("span",ue,"已经写了")):(p(),m("span",de,"已筛选出")),s("span",pe,T(x.value.length),1),t[0]||(t[0]=s("span",null,"篇文章",-1))])]),s("div",ve,[t[1]||(t[1]=s("div",{style:{"border-bottom":"2px solid #aaa","margin-top":"25px","margin-bottom":"1em"}},null,-1)),s("div",ge,[(p(!0),m(E,null,$(x.value,a=>(p(),W(J,{key:a.uuid,article:a,"is-show-updated-date":_.value,"is-show-placeholder":D.value},null,8,["article","is-show-updated-date","is-show-placeholder"]))),128)),x.value.length===0?(p(),m("p",me," 没有找到匹配的文章 ")):K("",!0)])])])],64))}}),ye=L(he,[["__scopeId","data-v-e4ff0edb"]]);export{ye as default};
