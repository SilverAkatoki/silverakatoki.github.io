import{d as k,r as h,o as R,a as B,w as U,c as g,b as s,e as I,t as A,u as C,v as q,f as H,n as z,F as E,g as F,h as N,i as d,j as S,k as V,_ as $,l as y,m as G,s as M,p as O,q as j,A as K}from"./index-QBhjp-1O.js";import{t as b,D as W,c as J,S as _,A as Q,F as X,a as Y}from"./ArticleSearchPanel-CNhGvigQ.js";const Z={class:"article-tags-selector"},ee={class:"header"},te={class:"title"},se={class:"tag-count"},ae=k({__name:"TagExplorerPanel",setup(L){const r=h(!1),p=h(!1),o=h(null),m=h(null);R(()=>{o.value&&(m.value=new ResizeObserver(()=>{T()}),m.value.observe(o.value)),T()}),B(()=>{m.value&&m.value.disconnect()});const T=()=>{D(),w()},D=()=>{if(o.value===null)return;const i=o.value,v=i.style.maxHeight;i.style.maxHeight="none";const f=i.scrollHeight;i.style.maxHeight=v;const c=i.querySelector(".tag-item")?.clientHeight||0;f>c?p.value=!0:(p.value=!1,r.value=!1)},w=()=>{if(o.value!==null)if(r.value)o.value.style.maxHeight="none";else{const i=o.value.querySelector(".tag-item")?.clientHeight||0;o.value.style.maxHeight=`${i}px`}};return U(r,w),window.addEventListener("resize",D),(i,v)=>{const f=N("router-link");return d(),g("div",Z,[s("div",ee,[s("span",te,"总共有 "+A(C(b).length)+" 个标签",1),I(s("button",{class:"toggle-btn",onClick:v[0]||(v[0]=c=>r.value=!r.value)},[H(A(r.value?"收起":"展开")+" ",1),s("span",{class:z(["arrow",r.value?"up":"down"])},null,2)],512),[[q,p.value]])]),s("div",{ref_key:"tagsContainerRef",ref:o,class:"tags-container"},[(d(!0),g(E,null,F(C(b),c=>(d(),g("div",{key:c[0],class:"tag-item"},[S(f,{to:{path:"/tag",query:{tag:c[0]}},class:"tag-link"},{default:V(()=>[v[1]||(v[1]=s("span",{class:"bullet"},null,-1)),H(" "+A(c[0]),1)]),_:2},1032,["to"]),s("span",se,"("+A(c[1])+")",1)]))),128))],512)])}}}),le=$(ae,[["__scopeId","data-v-20ddb300"]]),oe={class:"body_container"},ne={class:"filter-container"},re={class:"article-count-container"},ie={key:0},ce={key:1},ue={class:"article-count"},de={class:"articles"},pe={class:"articles-container"},ve={key:0,class:"empty-state"},ge=k({__name:"Articles",setup(L){const r=h(""),p=h({...W}),o=h(J()),m=y(()=>{const{sortProperty:e}=p.value;return e===_.DEFAULT||e===_.UPDATED_DATE}),T=y(()=>{const{sortProperty:e}=p.value;return e===_.DEFAULT}),D=/<span>(.*?)<\/span>/gi,w=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),i=y(()=>o.value.rules.some(e=>e.values.length>0)),v=(e,t)=>{const a=t.type===X.TAG?e.tags:e.categories;return t.operator==="eq"?t.values.some(n=>a.includes(n)):t.values.every(n=>!a.includes(n))},f=e=>{const t=o.value.rules.filter(n=>n.values.length>0);if(t.length===0)return e;const a=o.value.matchMode==="all";return e.filter(n=>{const l=t.map(u=>v(n,u));return a?l.every(Boolean):l.some(Boolean)})},c=y(()=>{const e=r.value.trim(),t=G.map(l=>({...l,title:l.title.replace(D,"$1")})).filter(l=>l.title.toLocaleLowerCase().replace(/\s+/g,"").includes(e.toLocaleLowerCase().replace(/\s+/g,""))),a=f(t);if(e==="")return a;const n=new RegExp(w(e.replace(/\s+/g,"")).split("").join("\\s*"),"gi");return a.map(l=>({...l,title:l.title.replace(n,u=>`<span>${u}</span>`)}))}),x=y(()=>{const e=[...c.value],{sortDirection:t,sortProperty:a}=p.value;if(a===_.DEFAULT)return e.sort((l,u)=>u.updatedDate.localeCompare(l.updatedDate));const n=t==="ASC"?1:-1;if(_.CREATED_DATE===a)return e.sort((l,u)=>n*l.createdDate.localeCompare(u.createdDate));if(_.UPDATED_DATE===a)return e.sort((l,u)=>n*l.updatedDate.localeCompare(u.updatedDate));throw Error("Invalid sort property")}),P=(e,t,a)=>{p.value={...t},r.value=e,o.value=Y(a)};return R(()=>document.title=`${M.siteInfo.title} | 归档`),(e,t)=>(d(),g(E,null,[t[2]||(t[2]=s("div",{class:"title_container"},[s("p",{class:"main_title"},"归档")],-1)),s("div",oe,[S(le,{style:{"margin-bottom":"1.5em"}}),s("div",ne,[S(Q,{onSubmit:P}),s("div",re,[r.value===""&&!i.value?(d(),g("span",ie,"已经写了")):(d(),g("span",ce,"已筛选出")),s("span",ue,A(x.value.length),1),t[0]||(t[0]=s("span",null,"篇文章",-1))])]),s("div",de,[t[1]||(t[1]=s("div",{style:{"border-bottom":"2px solid #aaa","margin-top":"25px","margin-bottom":"1em"}},null,-1)),s("div",pe,[(d(!0),g(E,null,F(x.value,a=>(d(),j(K,{key:a.uuid,article:a,"is-show-updated-date":m.value,"is-show-placeholder":T.value},null,8,["article","is-show-updated-date","is-show-placeholder"]))),128)),x.value.length===0?(d(),g("p",ve," 没有找到匹配的文章 ")):O("",!0)])])])],64))}}),_e=$(ge,[["__scopeId","data-v-454e1db3"]]);export{_e as default};
